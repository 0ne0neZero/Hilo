/**
 * Hilo 1.1.0 for standalone
 * Copyright 2016 alibaba.com
 * Licensed under the MIT License
 */
!function(e){var t=e.Hilo,n=t.Class,i=t.Container,r=t.CanvasRenderer,s=t.DOMRenderer,a=t.WebGLRenderer,o=t.browser,h=t.util,d=n.create({Extends:i,constructor:function(e){e=e||{},this.id=this.id||e.id||t.getUid("Stage"),d.superclass.constructor.call(this,e),this._initRenderer(e);var n=this.width,i=this.height,r=this.updateViewport();e.width||(n=r&&r.width||320),e.height||(i=r&&r.height||480),this.resize(n,i,!0)},canvas:null,renderer:null,paused:!1,viewport:null,_initRenderer:function(e){var n=e.canvas,i=e.container,o=e.renderType||"canvas";if("string"==typeof n&&(n=t.getElement(n)),"string"==typeof i&&(i=t.getElement(i)),n)n.getContext||(o="dom");else{var h="dom"===o?"div":"canvas";n=t.createElement(h,{style:{position:"absolute"}})}this.canvas=n,i&&i.appendChild(n);var d={canvas:n,stage:this};switch(o){case"dom":this.renderer=new s(d);break;case"webgl":a.isSupport()?this.renderer=new a(d):this.renderer=new r(d);break;case"canvas":default:this.renderer=new r(d)}},addTo:function(e){var t=this.canvas;return t.parentNode!==e&&e.appendChild(t),this},tick:function(e){this.paused||this._render(this.renderer,e)},enableDOMEvent:function(e,t){var n=this,i=n.canvas,r=n._domListener||(n._domListener=function(e){n._onDOMEvent(e)});e="string"==typeof e?[e]:e,t=t!==!1;for(var s=0;s<e.length;s++){var a=e[s];t?i.addEventListener(a,r,!1):i.removeEventListener(a,r)}return n},_onDOMEvent:function(e){var t=e.type,n=e,i=0==t.indexOf("touch"),r=e;if(i){var s=e.touches,a=e.changedTouches;r=s&&s.length?s[0]:a&&a.length?a[0]:null}var d=r.pageX||r.clientX,u=r.pageY||r.clientY,c=this.viewport||this.updateViewport();n.stageX=d=(d-c.left)/this.scaleX,n.stageY=u=(u-c.top)/this.scaleY,n.stopPropagation=function(){this._stopPropagationed=!0};var v=this.getViewAtPoint(d,u,!0,!1,!0)||this,l=this.canvas,p=this._eventTarget,g="mouseout"===t;if(p&&(p!=v&&(!p.contains||!p.contains(v))||g)){var f="touchmove"===t?"touchout":"mousemove"===t||g||!v?"mouseout":null;if(f){var w=h.copy({},n);w.type=f,w.eventTarget=p,p._fireMouseEvent(w)}n.lastEventTarget=p,this._eventTarget=null}if(v&&v.pointerEnabled&&"mouseout"!==t&&(n.eventTarget=this._eventTarget=v,v._fireMouseEvent(n)),!i){var m=v&&v.pointerEnabled&&v.useHandCursor?"pointer":"";l.style.cursor=m}o.android&&"touchmove"===t&&e.preventDefault()},updateViewport:function(){var e=this.canvas,n=null;return e.parentNode&&(n=this.viewport=t.getElementRect(e)),n},resize:function(e,t,n){(n||this.width!==e||this.height!==t)&&(this.width=e,this.height=t,this.renderer.resize(e,t),this.updateViewport())}});t.Stage=d}(window);